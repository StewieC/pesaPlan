{% extends 'finance/base.html' %}
{% block content %}
  <h2>Dashboard</h2>
  <p>Welcome, {{ user.username }}!</p>
  {% if latest_budget %}
    <div class="summary-card">
      <h3>Current Budget Summary ({{ latest_budget.month }})</h3>
      <p>Total Budget: {{ latest_budget.total_amount }} KSH</p>
      <p>Allocated: {{ total_allocated }} KSH</p>
      <p>Savings: {{ savings }} KSH</p>
      {% if savings < 0 %}
  <p class="error">Over Budget by {{ over_budget_amount }} KSH!</p>
      {% endif %}
    </div>
  {% else %}
    <p>No budgets yet. <a href="{% url 'finance:budget_create' %}">Create your first budget</a>.</p>
  {% endif %}
  {% if budgets %}
    <h3>Your Budgets</h3>
    <table>
      <tr>
        <th>Month</th>
        <th>Total Amount (KSH)</th>
        <th>Actions</th>
      </tr>
      {% for budget in budgets %}
        <tr>
          <td>{{ budget.month }}</td>
          <td>{{ budget.total_amount }}</td>
          <td>
            <a href="{% url 'finance:budget_detail' budget.pk %}" class="btn" style="background-color: #007bff;">View</a>
            <a href="{% url 'finance:allocation_create' budget.pk %}" class="btn" style="background-color: #28a745;">Add Allocation</a>
          </td>
        </tr>
      {% endfor %}
    </table>
  {% endif %}

  <style>
    .summary-card {
      border: 1px solid #ddd;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th { background-color: #f2f2f2; }
  </style>
{% endblock %}